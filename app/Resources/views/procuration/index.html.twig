{% extends 'base.html.twig' %}

{% macro start_form(form) %}
    <section class="l__wrapper">
        <div class="procuration__banner__form">
            <h4>Mon lieu de vote</h4>

            <form method="post" action="{{ path('app_procuration_request_address') }}">
                <div class="form__row">
                    {{ form_label(form.voteCountry, 'Le pays de mon lieu de vote') }}
                    {{ form_errors(form.voteCountry) }}
                    {{ form_widget(form.voteCountry, { 'attr': { 'class': 'form--full' } }) }}
                </div>

                <div class="form__row">
                    {{ form_label(form.votePostalCode, 'Le code postal de mon lieu de vote') }}
                    {{ form_errors(form.votePostalCode) }}
                    {{ form_widget(form.votePostalCode, { 'attr': { 'class': 'form--full', 'placeholder': 'Code postal' } }) }}
                </div>

                <div class="form__row">
                    {{ form_label(form.voteCity, 'La ville dans laquelle je vote') }}
                    {{ form_widget(form.voteCity) }}
                    {{ form_widget(form.voteCityName, { 'attr': { 'class': 'form--full', 'placeholder': 'Ville' } }) }}
                    {{ form_errors(form.voteCity) }}
                </div>

                {{ form_rest(form) }}

                <div class="text--center">
                    <button type="submit" class="btn btn--primary btn--medium">
                        Je continue
                    </button>
                </div>
            </form>
        </div>
    </section>
{% endmacro %}

{% import _self as procuration %}

{% block page_title 'Procuration' %}

{% block javascripts %}
    <script type="text/javascript">
        Kernel.onLoad(function() {
            {% for form in forms %}
                App.createAddressSelector(
                    '{{ form.voteCountry.vars.id }}',
                    '{{ form.votePostalCode.vars.id }}',
                    '{{ form.voteCity.vars.id }}',
                    '{{ form.voteCityName.vars.id }}'
                );
            {% endfor %}
        });
    </script>
{% endblock %}

{% block content %}
<main class="procuration">
    <section class="l__wrapper">
        <header class="procuration__header text--center">
            <h2 class="procuration__header__title">
                Ne gâchez pas votre vote
            </h2>
            <h3 class="procuration__header__subtitle">
                Faîtes procuration
            </h3>
        </header>
    </section>

    <section class="procuration__banner procuration__banner--form-right progressive-background"
             data-sd="{{ static_asset('procuration/banner-header.jpg', {'w': 300, 'q': 20}) }}"
             data-hd="{{ static_asset('procuration/banner-header.jpg', {'w': 2000, 'q': 70}) }}">
        {{ procuration.start_form(forms.header) }}
    </section>

    <section class="l__wrapper procuration__explaination">
        <!-- TODO -->
    </section>

    <section class="procuration__banner procuration__banner--form-left progressive-background"
             data-sd="{{ static_asset('procuration/banner-footer.jpg', {'w': 300, 'q': 20}) }}"
             data-hd="{{ static_asset('procuration/banner-footer.jpg', {'w': 2000, 'q': 70}) }}">
        {{ procuration.start_form(forms.footer) }}
    </section>
</main>

{% endblock %}
