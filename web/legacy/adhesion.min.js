function handleFormReturn(e,r,i){return e=JSON.parse(e),e.success?r():i(e.error,e.field)}function Adhesion(){this.initialize()}Function.prototype.bind||(Function.prototype.bind=function(e){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - ce qui est à lier ne peut être appelé");var r=Array.prototype.slice.call(arguments,1),i=this,n=function(){},o=function(){return i.apply(this instanceof n?this:e,r.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(n.prototype=this.prototype),o.prototype=new n,o}),$.extend($.validator.messages,{required:"Ce champ est obligatoire.",remote:"Veuillez corriger ce champ.",email:"Veuillez fournir une adresse électronique valide.",url:"Veuillez fournir une adresse URL valide.",date:"Veuillez fournir une date valide.",dateISO:"Veuillez fournir une date valide (ISO).",number:"Veuillez fournir un numéro valide.",digits:"Veuillez fournir seulement des chiffres.",creditcard:"Veuillez fournir un numéro de carte de crédit valide.",equalTo:"Confirmez votre mot de passe",extension:"Veuillez fournir une valeur avec une extension valide.",maxlength:$.validator.format("Veuillez fournir au plus {0} caractères."),minlength:$.validator.format("Veuillez fournir au moins {0} caractères."),rangelength:$.validator.format("Veuillez fournir une valeur qui contient entre {0} et {1} caractères."),range:$.validator.format("Veuillez fournir une valeur entre {0} et {1}."),max:$.validator.format("Veuillez fournir une valeur inférieure ou égale à {0}."),min:$.validator.format("Veuillez fournir une valeur supérieure ou égale à {0}."),maxWords:$.validator.format("Veuillez fournir au plus {0} mots."),minWords:$.validator.format("Veuillez fournir au moins {0} mots."),rangeWords:$.validator.format("Veuillez fournir entre {0} et {1} mots."),letterswithbasicpunc:"Veuillez fournir seulement des lettres et des signes de ponctuation.",alphanumeric:"Veuillez fournir seulement des lettres, nombres, espaces et soulignages.",lettersonly:"Veuillez fournir seulement des lettres.",nowhitespace:"Veuillez ne pas inscrire d'espaces blancs.",ziprange:"Veuillez fournir un code postal entre 902xx-xxxx et 905-xx-xxxx.",integer:"Veuillez fournir un nombre non décimal qui est positif ou négatif.",vinUS:"Veuillez fournir un numéro d'identification du véhicule (VIN).",dateITA:"Veuillez fournir une date valide.",time:"Veuillez fournir une heure valide entre 00:00 et 23:59.",phoneIntl:"Veuillez fournir un numéro de téléphone valide.",phoneUS:"Veuillez fournir un numéro de téléphone valide.",phoneUK:"Veuillez fournir un numéro de téléphone valide.",mobileUK:"Veuillez fournir un numéro de téléphone mobile valide.",strippedminlength:$.validator.format("Veuillez fournir au moins {0} caractères."),email2:"Veuillez fournir une adresse électronique valide.",url2:"Veuillez fournir une adresse URL valide.",creditcardtypes:"Veuillez fournir un numéro de carte de crédit valide.",ipv4:"Veuillez fournir une adresse IP v4 valide.",ipv6:"Veuillez fournir une adresse IP v6 valide.",require_from_group:"Veuillez fournir au moins {0} de ces champs.",nifES:"Veuillez fournir un numéro NIF valide.",nieES:"Veuillez fournir un numéro NIE valide.",cifES:"Veuillez fournir un numéro CIF valide.",postalCodeCA:"Veuillez fournir un code postal valide."}),jQuery.validator.addMethod("correctName",function(e,r){return!!/^[a-z- ’'àèìòùÀÈÌÒÙáéíóúýÁÉÍÓÚÝâêîôûÂÊÎÔÛãñõÃÑÕäëïöüÿÄËÏÖÜŸçÇßØøÅåÆæœ]+$/i.test(e)},"Merci d'indiquer un nom correct."),$.validator.addMethod("haveMoreThan16",function(e,r){return this.optional(r)||parseInt(e)>=15},"Vous devez avoir au moins 15 ans pour adhérer.");var onAdhesionErrorPlacement=function(e,r){var i=$(r);"conditions"==i.attr("id")?i.parent(".checkbox").before(e):"gender"==i.attr("name")?i.parents(".form-group").before(e):i.parent("label").length>0?i.parent("label").after(e):i.after(e)};Adhesion.prototype={isCheckboxesValid:function(){var e=$(this.current()+" form"),r=e.valid();return console.log("Form valid (1) ?",r),_.each($(e).find("input[type='checkbox']"),function(e){var i=$(e)[0],n=$(e).attr("id");0==i.checked?($(i).parents("black-checkbox").append('<label id="'+n+'_error" class="error" for="'+n+"\">Merci d'accepter cette condition.</label>"),r=!1):$("#"+n+"_error").remove()}),console.log("Form is valid ? ",r),r},bindFormsValidations:function(){_.each($("form"),function(e){console.log("binding ",e),$(e).validate({onsubmit:!0,ignore:[],errorElement:"label",rules:{firstname:{correctName:!0},lastname:{correctName:!0},password:{required:!0,minlength:8},password_confirm:{equalTo:"#password"},phone:{phoneIntl:!0},mobilephone:{phoneIntl:!0},age:{haveMoreThan16:!0}},errorPlacement:onAdhesionErrorPlacement,submitHandler:function(){return!0}})})},initialize:function(){this.bindFormsValidations();var e=function(e){var r='<option value="<%= VILLE %>"><%= _.upperFirst(_.lowerCase(VILLE)) %></option>';if(e.success){var i=e.data;$("#ville").detach(),$("label[for='ville']").after('<select name="ville" id="ville" class="form-control" required></select>'),select=$("#ville"),_.each(i,function(e){$(select).append(_.template(r)(e))}),$("label[for='ville']").parent().addClass("select")}else $("#ville").detach(),$("label[for='ville']").parent().removeClass("select"),$("label[for='ville']").after('<input type="text" autocomplete="off" class="form-control" name="ville" id="ville" placeholder="Ville" required>')},r=function(){var r=$(this).val(),i="/ajax.php?action=get-ville&cp="+r;$.getJSON(i).success(function(r){e(r),console.log("DATA: ",r)}).error(function(e){console.log("ERROR",e)})};$("#code_postal").change(r),r.bind($("#code_postal")).call()}},$(function(){$("#form-adhesion").length>0&&(window.adhesion=new Adhesion)});